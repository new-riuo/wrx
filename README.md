# 报关单管理系统

## 功能介绍

报关单管理系统是一个用于管理和生成报关单的工具，主要功能包括：

1. **物流信息导入**：导入物流信息表，自动抓取实际发货物流字段的"US"和红底的"DHL"并保存
2. **订单信息导入**：导入订单信息表，根据物流信息匹配对应数据
3. **报关单模板设置**：管理报关单模板字段，包括30个必填和选填字段
4. **报关信息维护**：查看、添加、修改和删除报关信息
5. **其他信息维护**：管理国家代码、币种、店铺对应公司等基础数据

## 安装说明

### 环境要求
- Python 3.6+
- Windows系统

### 安装依赖

1. 安装openpyxl库（用于读取.xlsx文件）：
   ```
   pip install openpyxl
   ```

2. 安装xlrd库（用于读取.xls文件，可选）：
   ```
   pip install xlrd
   ```

## 使用方法

### 启动程序

在命令行中运行以下命令启动程序：
```
python excel_manager.py
```

### 主要功能使用

#### 1. 物流信息导入

1. 点击"物流信息导入"标签页
2. 点击"导入物流信息表"按钮，选择要导入的Excel文件
3. 点击"处理物流信息"按钮，系统会自动抓取实际发货物流字段的"US"和红底的"DHL"并保存
4. 点击"刷新物流数据"按钮，查看处理后的物流数据

#### 2. 订单信息导入

1. 点击"订单信息导入"标签页
2. 点击"导入订单信息表"按钮，选择要导入的Excel文件
3. 点击"匹配订单数据"按钮，系统会根据平台订单号匹配物流信息和订单信息
4. 点击"刷新订单数据"按钮，查看匹配后的订单数据

#### 3. 报关单模板设置

1. 点击"报关单模板设置"标签页
2. 查看当前的报关单模板字段
3. 点击"保存模板设置"按钮，保存模板设置

#### 4. 报关信息维护

1. 点击"报关信息维护"标签页
2. 点击"刷新报关信息"按钮，查看当前的报关信息
3. 点击"添加报关信息"按钮，添加新的报关信息
4. 点击"修改报关信息"按钮，修改选中的报关信息
5. 点击"删除报关信息"按钮，删除选中的报关信息

#### 5. 其他信息维护

1. 点击"其他信息维护"标签页
2. 选择要维护的信息类型（国家代码维护、币种维护、店铺对应公司维护）
3. 点击"刷新XX数据"按钮，查看当前数据
4. 点击"添加XX"按钮，添加新数据
5. 点击"保存XX数据"按钮，保存数据

## 文件说明

- `excel_manager.py`：主程序文件，包含GUI界面实现
- `excel_process.py`：Excel处理类，包含各种功能实现
- `template_config.json`：模板配置文件，存储模板配置信息
- `当前工作簿.xlsx`：临时存储数据的Excel文件
- `导入模板/`：生成的模板文件目录

## 注意事项

1. **文件格式支持**：
   - 支持.xlsx和.xlsm格式的Excel文件
   - 支持.xls格式的Excel文件（需要安装xlrd库）

2. **数据匹配**：
   - 物流信息和订单信息通过"平台订单号"字段进行匹配
   - 请确保导入的物流信息表和订单信息表中都包含"平台订单号"字段
   - 报关单各字段匹配：
      - "提单号": 订单号所属店铺的公司的报关信息的提单号
      -"商品品名": 订单号所属店铺的公司的报关信息的商品品名
      -"HS CODE": 订单号所属店铺的公司的报关信息的HS CODE
      -"规格型号": 订单号所属店铺的公司的报关信息的规格型号
      -"包裹内单个SKC的商品数量": 订单号所属店铺的公司的报关信息的包裹内单个SKC的商品数量,
      -"申报单位": 订单号所属店铺的公司的报关信息的申报单位,
      -"申报币制": 订单号所属店铺的公司的报关信息的申报币制,
      -"商品总净重(KG)": 订单号所属店铺的公司的报关信息的商品总净重(KG),
      -"第一法定数量": 订单号所属店铺的公司的报关信息的第一法定数量,
      -"第一法定单位": 订单号所属店铺的公司的报关信息的第一法定单位,
      -"电商企业代码": 订单号所属店铺的公司的报关信息的电商企业代码,
      -"电商企业名称": 订单号所属店铺的公司的报关信息的电商企业名称,
      -"电商平台代码": 订单号所属店铺的公司的报关信息的电商平台代码,
      -"电商平台名称": 订单号所属店铺的公司的报关信息的电商平台名称,
      -"收款企业代码": 订单号所属店铺的公司的报关信息的收款企业代码,
      -"收款企业名称": 订单号所属店铺的公司的报关信息的收款企业名称,
      -"生产企业代码": 订单号所属店铺的公司的报关信息的生产企业代码,
      -"生产企业名称": 订单号所属店铺的公司的报关信息的生产企业名称,
      -"电商企业dxpId": 订单号所属店铺的公司的报关信息的电商企业dxpId

3. **模板生成**：
   - 生成的模板文件保存在"导入模板"目录中
   - 模板文件命名格式：`模板名称+当前日期+x.xlsx`
   - 如果同名文件已存在，会自动增加数字后缀

4. **红底DHL识别**：
   - 当前版本中，红底DHL的识别是基于文本内容的，即包含"DHL"字符串
   - 后续版本将支持基于单元格格式的红底识别

## 常见问题

### 1. 导入.xls文件时提示"导入.xls文件需要安装xlrd库"

解决方法：运行以下命令安装xlrd库
```
pip install xlrd
```

### 2. 导入文件时提示"不支持的文件格式"

解决方法：确保选择的文件是.xls或.xlsx格式的Excel文件

### 3. 匹配订单数据时没有匹配结果

解决方法：
- 检查物流信息表和订单信息表中是否都包含"平台订单号"字段
- 检查"平台订单号"字段的值是否一致
- 确保物流信息表和订单信息表中的"平台订单号"字段没有空格或其他特殊字符

## 更新日志

### v1.0.0
- 初始版本
- 实现物流信息导入和处理功能
- 实现订单信息导入和匹配功能
- 实现报关单模板设置功能
- 实现报关信息维护功能
- 实现其他信息维护功能
- 支持.xls和.xlsx格式的Excel文件

## 联系方式

如有问题或建议，请联系开发者。
